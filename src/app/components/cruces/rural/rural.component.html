<form [formGroup]="actividadesForm">
    <mat-tab-group mat-align-tabs="start">
        <div formArrayName="act" fxFlex="100%">
            <div *ngFor="let acti of actividades().controls; let ac=index">
                <mat-tab label="Act {{ac}}">
                    <div [formGroupName]="ac" fxLayout="row wrap">
                        <!-- encabezado -->
                        <div class="encabezado">
                            <mat-card>
                                <mat-card-content>
                                    <div fxLayout="row wrap">

                                        <div class="gr" fxFlex="30%" fxFlex.xs="30%" fxFlex.sm="30%">
                                            <mat-form-field>
                                                <mat-label>Tipo Actividad</mat-label>
                                                <mat-select formControlName="tipo" id="tipo{{ac}}" required>
                                                    <mat-option>--</mat-option>
                                                    <mat-option *ngFor="let tip of tipoActRural" [value]="tip.id">
                                                        {{tip.name}}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                        <div class="gr" fxFlex="30%" fxFlex.xs="25%" fxFlex.sm="30%">
                                            <mat-form-field>
                                                <mat-label>Actividad</mat-label>
                                                <mat-select formControlName="nombre" id="nombre{{ac}}" required>
                                                    <mat-option>--</mat-option>
                                                    <mat-option *ngFor="let actru of ActRural" [value]="actru">
                                                        {{actru.name}}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                        <div class="gr" fxFlex="30%" fxFlex.xs="30%" fxFlex.sm="25%">
                                            <mat-form-field>
                                                <input type="text" matInput placeholder="Tipo Produccion"
                                                    value="{{acti.value.nombre.tipoproducto}}" id="tipoproduccion{{ac}}"
                                                    formControlName="tipoproduccion" readonly>
                                            </mat-form-field>
                                        </div>
                                    </div>
                                </mat-card-content>
                                <button *ngIf="acti.value.tipo ==1" mat-fab aria-label="add" mat-mini-fab class="btnadd"
                                    type="button" color="accent" (click)="addLotes(ac)">
                                    <mat-icon>add</mat-icon>
                                </button>
                                <button *ngIf="acti.value.tipo ==2" mat-fab aria-label="add" mat-mini-fab class="btnadd"
                                    type="button" color="accent" (click)="addLotesPecuario(ac)">
                                    <mat-icon>add</mat-icon>
                                </button>
                            </mat-card>
                        </div>

                        <ng-container [ngSwitch]="acti.value.tipo">
                            <!-- agricola -->
                            <ng-container *ngSwitchCase="1">
                                <!-- Lotes agro -->
                                <div formArrayName="lotesAgro">
                                    <div *ngFor="let lote of lotes(ac).controls; let lot=index" class="content"
                                        [formGroupName]="lot">

                                        <mat-card>
                                            <mat-card-header>
                                                <mat-card-title>Lote <span *ngIf="lot>0">{{lot}}</span> <span
                                                        *ngIf="lot==0">Principal</span></mat-card-title>
                                            </mat-card-header>
                                            <mat-card-content>
                                                <div fxLayout="row wrap">
                                                    <div class="gr" fxFlex="30%" fxFlex.xs="35%" fxFlex.sm="35%">
                                                        <mat-form-field>
                                                            <input type="number" matInput placeholder="Edad Cultivo"
                                                                id="edadcult{{ac}}-{{lot}}" formControlName="edadcult">
                                                        </mat-form-field>
                                                    </div>

                                                    <div class="gr" fxFlex="30%" fxFlex.xs="25%" fxFlex.sm="25%">
                                                        <mat-form-field>
                                                            <mat-label>Edad</mat-label>
                                                            <mat-select formControlName="periodoedad"
                                                                id="periodoedad{{ac}}-{{lot}}" required>
                                                                <mat-option>--</mat-option>
                                                                <mat-option *ngFor="let ed of edadPeriodo"
                                                                    [value]="ed.id">
                                                                    {{ed.name}}
                                                                </mat-option>
                                                            </mat-select>
                                                        </mat-form-field>
                                                    </div>

                                                    <div class="gr" fxFlex="30%" fxFlex.xs="15%" fxFlex.sm="15%">
                                                        <mat-form-field>
                                                            <input type="number" matInput placeholder="Area"
                                                                id="areacult{{ac}}-{{lot}}" formControlName="areacult">
                                                        </mat-form-field>
                                                    </div>
                                                    <div class="gr" fxFlex="100%" fxFlex.xs="100%" fxFlex.sm="25%">
                                                        <mat-card>
                                                            <mat-card-content>
                                                                <mat-slide-toggle formControlName="aplicadiastancia">
                                                                    Distancia de siembra
                                                                </mat-slide-toggle>
                                                            </mat-card-content>
                                                        </mat-card>
                                                    </div>
                                                    <br>

                                                    <ng-container *ngIf="lote.value.aplicadiastancia">
                                                        <div class="gr" fxFlex="100%" fxFlex.xs="100%" fxFlex.sm="100%">
                                                            <mat-form-field>
                                                                <input type="number" matInput placeholder="Distancia"
                                                                    id="diastancia{{ac}}-{{lot}}"
                                                                    formControlName="diastancia">
                                                            </mat-form-field>
                                                        </div>
                                                    </ng-container>

                                                    <div class="gr" fxFlex="100%" fxFlex.xs="100%" fxFlex.sm="25%">
                                                        <mat-card>
                                                            <mat-card-content>
                                                                <mat-slide-toggle
                                                                    formControlName="aplicaplantasinformacli">
                                                                    #plantas/semillas del lote
                                                                </mat-slide-toggle>
                                                            </mat-card-content>
                                                        </mat-card>
                                                    </div>

                                                    <ng-container *ngIf="lote.value.aplicaplantasinformacli">
                                                        <div class="gr" fxFlex="100%" fxFlex.xs="100%" fxFlex.sm="100%">
                                                            <mat-form-field>
                                                                <input type="number" matInput placeholder="#plantas"
                                                                    id="planatasinformacli{{ac}}-{{lot}}"
                                                                    formControlName="planatasinformacli">
                                                            </mat-form-field>
                                                        </div>
                                                    </ng-container>

                                                    <div class="gr" fxFlex="48%" fxFlex.xs="40%" fxFlex.sm="25%">
                                                        <mat-form-field>
                                                            <input type="number" matInput
                                                                placeholder="# plantas/semillas del lote"
                                                                id="numplantas{{ac}}-{{lot}}"
                                                                formControlName="numplantas">
                                                        </mat-form-field>
                                                    </div>

                                                    <div class="gr" fxFlex="50%" fxFlex.xs="40%" fxFlex.sm="25%">
                                                        <mat-form-field>
                                                            <mat-label>Unidad Venta</mat-label>
                                                            <mat-select formControlName="unidadventa"
                                                                id="unidadventa{{ac}}-{{lot}}" required>
                                                                <mat-option>--</mat-option>
                                                                <mat-option *ngFor="let un of unidades" [value]="un.id">
                                                                    {{un.name}}
                                                                </mat-option>
                                                            </mat-select>
                                                        </mat-form-field>
                                                    </div>
                                                    <div class="gr" fxFlex="100%" fxFlex.xs="100%">
                                                        <h3><b>Ingresos</b></h3>
                                                    </div>

                                                    <ng-container
                                                        *ngIf="acti.value.nombre.tipoproducto=='Transitorio';then transitoria;else permanentes">
                                                    </ng-container>
                                                    <ng-template #transitoria>
                                                        <div fxLayout="row wrap" class="contentingresos">
                                                            <div class="gr" fxFlex="30%" fxFlex.xs="25%"
                                                                fxFlex.sm="25%">
                                                                <mat-form-field>
                                                                    <input type="number" matInput
                                                                        placeholder="Rendimiento por lote"
                                                                        id="rendiemientolote{{ac}}-{{lot}}"
                                                                        formControlName="rendiemientolote">
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="gr" fxFlex="30%" fxFlex.xs="25%"
                                                                fxFlex.sm="25%">
                                                                <mat-form-field>
                                                                    <input type="number" matInput
                                                                        placeholder="Unidades totales"
                                                                        id="unidadestotales{{ac}}-{{lot}}"
                                                                        formControlName="unidadestotales">
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="gr" fxFlex="30%" fxFlex.xs="25%"
                                                                fxFlex.sm="25%">
                                                                <mat-form-field>
                                                                    <input type="number" matInput
                                                                        placeholder="% Perdida"
                                                                        id="perdida{{ac}}-{{lot}}"
                                                                        formControlName="perdida">
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="gr" fxFlex="30%" fxFlex.xs="27%"
                                                                fxFlex.sm="28%">
                                                                <mat-form-field>
                                                                    <input type="number" matInput
                                                                        placeholder="Precio Min"
                                                                        id="preciomin{{ac}}-{{lot}}"
                                                                        formControlName="preciomin">
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="gr" fxFlex="30%" fxFlex.xs="25%"
                                                                fxFlex.sm="25%">
                                                                <mat-form-field>
                                                                    <input type="number" matInput
                                                                        placeholder="Precio Promedio"
                                                                        id="preciopromedio{{ac}}-{{lot}}"
                                                                        formControlName="preciopromedio">
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="gr" fxFlex="30%" fxFlex.xs="25%"
                                                                fxFlex.sm="25%">
                                                                <mat-form-field>
                                                                    <input type="number" matInput placeholder="Total"
                                                                        id="totalIngreso{{ac}}-{{lot}}"
                                                                        formControlName="totalIngreso">
                                                                </mat-form-field>
                                                            </div>
                                                        </div>
                                                    </ng-template>

                                                    <ng-template #permanentes>
                                                        <mat-vertical-stepper linear="true" #stepper>
                                                            <mat-step state="check">
                                                                <div fxLayout="row wrap">
                                                                    <ng-template matStepLabel>Cocecha</ng-template>
                                                                    <div class="gr" fxFlex="30%" fxFlex.xs="40%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <mat-label>Rendimiento</mat-label>
                                                                            <input matInput placeholder="Rendimiento"
                                                                                formControlName="rendimientoCos">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="40%" fxFlex.xs="40%"
                                                                        fxFlex.sm="35%">
                                                                        <mat-form-field>
                                                                            <mat-label>Cocecha</mat-label>
                                                                            <mat-select formControlName="mesCos"
                                                                                multiple id="mesCos{{ac}}-{{lot}}"
                                                                                required>
                                                                                <mat-option *ngFor="let mes of meses"
                                                                                    [value]="mes.id">
                                                                                    {{mes.name}}
                                                                                </mat-option>
                                                                            </mat-select>
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="30%" fxFlex.xs="40%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <mat-label>Unidades Venta</mat-label>
                                                                            <input matInput placeholder="Unidades"
                                                                                formControlName="unidadesCos">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="30%" fxFlex.xs="40%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <mat-label>%Perdida</mat-label>
                                                                            <input matInput placeholder="Perdida"
                                                                                formControlName="perdidaCos">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="30%" fxFlex.xs="100%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <mat-label>%Cocecha</mat-label>
                                                                            <input matInput placeholder="Porcentage"
                                                                                formControlName="procentageCos">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div>
                                                                        <button mat-button color="primary"
                                                                            matStepperNext>Siguiente</button>
                                                                    </div>
                                                                </div>
                                                            </mat-step>
                                                            <mat-step>
                                                                <div fxLayout="row wrap">
                                                                    <ng-template matStepLabel>Traviesa
                                                                    </ng-template>
                                                                    <div class="gr" fxFlex="30%" fxFlex.xs="40%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <mat-label>Rendimiento</mat-label>
                                                                            <input matInput placeholder="Rendimiento"
                                                                                formControlName="rendimientoTra">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="40%" fxFlex.xs="40%"
                                                                        fxFlex.sm="35%">
                                                                        <mat-form-field>
                                                                            <mat-label>Traviesa</mat-label>
                                                                            <mat-select formControlName="mesTra"
                                                                                multiple id="mesTra{{ac}}-{{lot}}"
                                                                                required>
                                                                                <mat-option *ngFor="let mes of meses"
                                                                                    [value]="mes.id">
                                                                                    {{mes.name}}
                                                                                </mat-option>
                                                                            </mat-select>
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="30%" fxFlex.xs="40%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <mat-label>Unidades Venta</mat-label>
                                                                            <input matInput placeholder="Unidades"
                                                                                formControlName="unidadesTra">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="30%" fxFlex.xs="40%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <mat-label>%Perdida</mat-label>
                                                                            <input matInput placeholder="Perdida"
                                                                                formControlName="perdidaTra">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="30%" fxFlex.xs="100%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <mat-label>%Traviesa</mat-label>
                                                                            <input matInput placeholder="Porcentage"
                                                                                formControlName="procentageTra">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div>
                                                                        <button mat-button color="primary"
                                                                            matStepperPrevious>Atras</button>
                                                                        <button mat-button color="primary"
                                                                            matStepperNext>Siguiente</button>
                                                                    </div>
                                                                </div>
                                                            </mat-step>
                                                            <mat-step>
                                                                <div fxLayout="row wrap">
                                                                    <ng-template matStepLabel>Pepeo</ng-template>
                                                                    <div class="gr" fxFlex="30%" fxFlex.xs="40%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <mat-label>Rendimiento</mat-label>
                                                                            <input matInput placeholder="Rendimiento"
                                                                                formControlName="rendimientoPepeo">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="40%" fxFlex.xs="40%"
                                                                        fxFlex.sm="35%">
                                                                        <mat-form-field>
                                                                            <mat-label>Traviesa</mat-label>
                                                                            <mat-select formControlName="mesPepeo"
                                                                                multiple id="mesPepeo{{ac}}-{{lot}}"
                                                                                required>
                                                                                <mat-option *ngFor="let mes of meses"
                                                                                    [value]="mes.id">
                                                                                    {{mes.name}}
                                                                                </mat-option>
                                                                            </mat-select>
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="30%" fxFlex.xs="40%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <mat-label>Unidades Venta</mat-label>
                                                                            <input matInput placeholder="Unidades"
                                                                                formControlName="unidadesPepeo">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="30%" fxFlex.xs="40%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <mat-label>%Perdida</mat-label>
                                                                            <input matInput placeholder="Perdida"
                                                                                formControlName="perdidaPepeo">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="30%" fxFlex.xs="100%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <mat-label>%Traviesa</mat-label>
                                                                            <input matInput placeholder="Porcentage"
                                                                                formControlName="procentagePepeo">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <p>Informacion completada.</p>
                                                                </div>
                                                            </mat-step>

                                                        </mat-vertical-stepper>
                                                    </ng-template>
                                                    <div class="gr" fxFlex="100%" fxFlex.xs="100%">
                                                        <h3><b>Egresos</b></h3>
                                                    </div>
                                                    <ng-container
                                                        *ngIf="acti.value.nombre.tipoproducto=='Transitorio';then egresotransitorio">
                                                    </ng-container>

                                                    <ng-template #egresotransitorio>
                                                        <!-- fase adecuacion -->
                                                        <mat-card class="mat-card-fases">
                                                            <mat-card-header>
                                                                <mat-card-title>Fase Adecuacion</mat-card-title>
                                                                <mat-chip-list class="pull-right">
                                                                    <mat-chip color="accent" selected></mat-chip>
                                                                </mat-chip-list>
                                                            </mat-card-header>
                                                            <mat-card-content>
                                                                <div formArrayName="egresosAdecuacion"
                                                                    class="alternate">
                                                                    <div *ngFor="let egreso of egresadosAdecuacion(ac,lot).controls; let eg=index"
                                                                        [formGroupName]="eg">
                                                                        <div class="container" fxLayout="row wrap">
                                                                            <div class="gr" fxFlex="40%" fxFlex.xs="40%"
                                                                                fxFlex.sm="25%">
                                                                                <mat-form-field>
                                                                                    <input type="text" matInput
                                                                                        placeholder="descripcion"
                                                                                        id="descripcion{{lot}}-{{eg}}"
                                                                                        formControlName="descripcion">
                                                                                </mat-form-field>
                                                                            </div>
                                                                            <div class="gr" fxFlex="40%" fxFlex.xs="40%"
                                                                                fxFlex.sm="25%">
                                                                                <mat-form-field>
                                                                                    <input type="text" matInput
                                                                                        placeholder="detalle"
                                                                                        id="detalle{{lot}}-{{eg}}"
                                                                                        formControlName="detalle">
                                                                                </mat-form-field>
                                                                            </div>
                                                                            <div class="gr" fxFlex="40%" fxFlex.xs="20%"
                                                                                fxFlex.sm="25%">
                                                                                <mat-form-field>
                                                                                    <input type="text" matInput
                                                                                        placeholder="cantidad"
                                                                                        id="cantidad{{lot}}-{{eg}}"
                                                                                        formControlName="cantidad">
                                                                                </mat-form-field>
                                                                            </div>
                                                                            <div class="gr" fxFlex="30%" fxFlex.xs="30%"
                                                                                fxFlex.sm="25%">
                                                                                <mat-form-field>
                                                                                    <input type="number" matInput
                                                                                        placeholder="valorunitario"
                                                                                        id="valorunitario{{lot}}-{{eg}}"
                                                                                        formControlName="valorunitario">
                                                                                </mat-form-field>
                                                                            </div>
                                                                            <div class="gr" fxFlex="40%" fxFlex.xs="30%"
                                                                                fxFlex.sm="25%">
                                                                                <mat-form-field>
                                                                                    <input type="number" matInput
                                                                                        placeholder="total"
                                                                                        id="total{{lot}}-{{eg}}"
                                                                                        formControlName="total">
                                                                                </mat-form-field>
                                                                            </div>
                                                                            <div class="gr" fxFlex="40%" fxFlex.xs="40%"
                                                                                fxFlex.sm="35%">
                                                                                <mat-form-field>
                                                                                    <mat-label>Mes</mat-label>
                                                                                    <mat-select formControlName="mes"
                                                                                        multiple id="mes{{lot}}-{{eg}}"
                                                                                        required>
                                                                                        <mat-option
                                                                                            *ngFor="let mes of meses"
                                                                                            [value]="mes.id">
                                                                                            {{mes.name}}
                                                                                        </mat-option>
                                                                                    </mat-select>
                                                                                </mat-form-field>
                                                                            </div>

                                                                            <button class="btndelete" color="warn"
                                                                                mat-icon-button [disabled]="eg ==0"
                                                                                (click)="removeEgresosAdecuacion(ac,lot,eg)">
                                                                                <mat-icon>cancel</mat-icon>
                                                                            </button>

                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <button mat-fab aria-label="add"
                                                                    (click)="addEgresosAdecuacion(ac,lot)" mat-mini-fab
                                                                    class="btnadd" type="button" color="accent">
                                                                    <mat-icon>add</mat-icon>
                                                                </button>
                                                            </mat-card-content>
                                                        </mat-card>
                                                        <!-- Fase Siembra -->
                                                        <mat-card class="mat-card-fases">
                                                            <mat-card-header>
                                                                <mat-card-title>Fase Siembra</mat-card-title>
                                                                <mat-chip-list class="pull-right">
                                                                    <mat-chip color="accent" selected></mat-chip>
                                                                </mat-chip-list>
                                                            </mat-card-header>
                                                            <mat-card-content>
                                                                <div formArrayName="egresosSiembra" class="alternate">
                                                                    <div *ngFor="let egreso of egresadosSiembra(ac,lot).controls; let eg=index"
                                                                        [formGroupName]="eg">
                                                                        <div class="container" fxLayout="row wrap">
                                                                            <div class="gr" fxFlex="40%" fxFlex.xs="40%"
                                                                                fxFlex.sm="25%">
                                                                                <mat-form-field>
                                                                                    <input type="text" matInput
                                                                                        placeholder="descripcion"
                                                                                        id="descripcion{{lot}}-{{eg}}"
                                                                                        formControlName="descripcion">
                                                                                </mat-form-field>
                                                                            </div>
                                                                            <div class="gr" fxFlex="40%" fxFlex.xs="40%"
                                                                                fxFlex.sm="25%">
                                                                                <mat-form-field>
                                                                                    <input type="text" matInput
                                                                                        placeholder="detalle"
                                                                                        id="detalle{{lot}}-{{eg}}"
                                                                                        formControlName="detalle">
                                                                                </mat-form-field>
                                                                            </div>
                                                                            <div class="gr" fxFlex="40%" fxFlex.xs="20%"
                                                                                fxFlex.sm="25%">
                                                                                <mat-form-field>
                                                                                    <input type="text" matInput
                                                                                        placeholder="cantidad"
                                                                                        id="cantidad{{lot}}-{{eg}}"
                                                                                        formControlName="cantidad">
                                                                                </mat-form-field>
                                                                            </div>
                                                                            <div class="gr" fxFlex="30%" fxFlex.xs="30%"
                                                                                fxFlex.sm="25%">
                                                                                <mat-form-field>
                                                                                    <input type="number" matInput
                                                                                        placeholder="valorunitario"
                                                                                        id="valorunitario{{lot}}-{{eg}}"
                                                                                        formControlName="valorunitario">
                                                                                </mat-form-field>
                                                                            </div>
                                                                            <div class="gr" fxFlex="40%" fxFlex.xs="30%"
                                                                                fxFlex.sm="25%">
                                                                                <mat-form-field>
                                                                                    <input type="number" matInput
                                                                                        placeholder="total"
                                                                                        id="total{{lot}}-{{eg}}"
                                                                                        formControlName="total">
                                                                                </mat-form-field>
                                                                            </div>
                                                                            <div class="gr" fxFlex="40%" fxFlex.xs="40%"
                                                                                fxFlex.sm="35%">
                                                                                <mat-form-field>
                                                                                    <mat-label>Mes</mat-label>
                                                                                    <mat-select formControlName="mes"
                                                                                        multiple id="mes{{lot}}-{{eg}}"
                                                                                        required>
                                                                                        <mat-option
                                                                                            *ngFor="let mes of meses"
                                                                                            [value]="mes.id">
                                                                                            {{mes.name}}
                                                                                        </mat-option>
                                                                                    </mat-select>
                                                                                </mat-form-field>
                                                                            </div>
                                                                            <button type="button" class="btndelete"
                                                                                color="warn" mat-icon-button
                                                                                [disabled]="eg ==0"
                                                                                (click)="removeEgresosSiembra(ac,lot,eg)">
                                                                                <mat-icon>cancel</mat-icon>
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <button mat-fab aria-label="add"
                                                                    (click)="addEgresosSiembra(ac,lot)" mat-mini-fab
                                                                    class="btnadd" type="button" color="accent">
                                                                    <mat-icon>add</mat-icon>
                                                                </button>
                                                            </mat-card-content>
                                                        </mat-card>
                                                    </ng-template>
                                                    <!-- fase mantenimiento -->
                                                    <mat-card class="mat-card-fases">
                                                        <mat-card-header>
                                                            <mat-card-title>Fase Mantenimiento</mat-card-title>
                                                            <mat-chip-list class="pull-right">
                                                                <mat-chip color="accent" selected></mat-chip>
                                                            </mat-chip-list>
                                                        </mat-card-header>
                                                        <mat-card-content>
                                                            <div formArrayName="egresosMante" class="alternate">
                                                                <div fxLayout="row wrap"
                                                                    *ngFor="let egreso of egresadosMante(ac,lot).controls; let eg=index"
                                                                    class="content" [formGroupName]="eg">

                                                                    <div class="gr" fxFlex="40%" fxFlex.xs="40%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <input type="text" matInput
                                                                                placeholder="descripcion"
                                                                                id="descripcion{{lot}}-{{eg}}"
                                                                                formControlName="descripcion">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="40%" fxFlex.xs="40%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <input type="text" matInput
                                                                                placeholder="detalle"
                                                                                id="detalle{{lot}}-{{eg}}"
                                                                                formControlName="detalle">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="40%" fxFlex.xs="20%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <input type="text" matInput
                                                                                placeholder="cantidad"
                                                                                id="cantidad{{lot}}-{{eg}}"
                                                                                formControlName="cantidad">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="30%" fxFlex.xs="30%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <input type="number" matInput
                                                                                placeholder="valorunitario"
                                                                                id="valorunitario{{lot}}-{{eg}}"
                                                                                formControlName="valorunitario">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="40%" fxFlex.xs="30%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <input type="number" matInput
                                                                                placeholder="total"
                                                                                id="total{{lot}}-{{eg}}"
                                                                                formControlName="total">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="40%" fxFlex.xs="40%"
                                                                        fxFlex.sm="35%">
                                                                        <mat-form-field>
                                                                            <mat-label>Mes</mat-label>
                                                                            <mat-select formControlName="mes" multiple
                                                                                id="mes{{lot}}-{{eg}}" required>
                                                                                <mat-option *ngFor="let mes of meses"
                                                                                    [value]="mes.id">
                                                                                    {{mes.name}}
                                                                                </mat-option>
                                                                            </mat-select>
                                                                        </mat-form-field>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <button mat-fab aria-label="add"
                                                                (click)="addEgresosMantenimiento(ac,lot)" mat-mini-fab
                                                                class="btnadd" type="button" color="accent">
                                                                <mat-icon>add</mat-icon>
                                                            </button>
                                                        </mat-card-content>
                                                    </mat-card>
                                                    <!-- fase Cocecha -->
                                                    <mat-card class="mat-card-fases">
                                                        <mat-card-header>
                                                            <mat-card-title>Fase Cocecha</mat-card-title>
                                                            <mat-chip-list class="pull-right">
                                                                <mat-chip color="accent" selected></mat-chip>
                                                            </mat-chip-list>
                                                        </mat-card-header>
                                                        <mat-card-content>
                                                            <div formArrayName="egresosCocecha" class="alternate">
                                                                <div fxLayout="row wrap"
                                                                    *ngFor="let egreso of egresadosCocecha(ac,lot).controls; let eg=index"
                                                                    class="content" [formGroupName]="eg">

                                                                    <div class="gr" fxFlex="40%" fxFlex.xs="40%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <input type="text" matInput
                                                                                placeholder="descripcion"
                                                                                id="descripcion{{lot}}-{{eg}}"
                                                                                formControlName="descripcion">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="40%" fxFlex.xs="40%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <input type="text" matInput
                                                                                placeholder="detalle"
                                                                                id="detalle{{lot}}-{{eg}}"
                                                                                formControlName="detalle">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="40%" fxFlex.xs="20%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <input type="text" matInput
                                                                                placeholder="cantidad"
                                                                                id="cantidad{{lot}}-{{eg}}"
                                                                                formControlName="cantidad">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="30%" fxFlex.xs="30%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <input type="number" matInput
                                                                                placeholder="valorunitario"
                                                                                id="valorunitario{{lot}}-{{eg}}"
                                                                                formControlName="valorunitario">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="40%" fxFlex.xs="30%"
                                                                        fxFlex.sm="25%">
                                                                        <mat-form-field>
                                                                            <input type="number" matInput
                                                                                placeholder="total"
                                                                                id="total{{lot}}-{{eg}}"
                                                                                formControlName="total">
                                                                        </mat-form-field>
                                                                    </div>
                                                                    <div class="gr" fxFlex="40%" fxFlex.xs="40%"
                                                                        fxFlex.sm="35%">
                                                                        <mat-form-field>
                                                                            <mat-label>Mes</mat-label>
                                                                            <mat-select formControlName="mes" multiple
                                                                                id="mes{{lot}}-{{eg}}" required>
                                                                                <mat-option *ngFor="let mes of meses"
                                                                                    [value]="mes.id">
                                                                                    {{mes.name}}
                                                                                </mat-option>
                                                                            </mat-select>
                                                                        </mat-form-field>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <button mat-fab aria-label="add"
                                                                (click)="addEgresosCocecho(ac,lot)" mat-mini-fab
                                                                class="btnadd" type="button" color="accent">
                                                                <mat-icon>add</mat-icon>
                                                            </button>
                                                        </mat-card-content>
                                                    </mat-card>


                                                </div>
                                            </mat-card-content>
                                            <button (click)="removeLotes(ac,lot)" color="warn" mat-icon-button
                                                class="deletelote" type="button">
                                                <mat-icon>cancel</mat-icon>
                                            </button>
                                        </mat-card>


                                    </div>
                                </div>
                            </ng-container>
                            <!-- pecuario -->
                            <ng-container *ngSwitchCase="2">
                                <div formArrayName="lotesPecuario">
                                    <div *ngFor="let lote of lotesPecuario(ac).controls; let lot=index" class="content"
                                        [formGroupName]="lot">
                                        <div fxLayout="row wrap">
                                            <fieldset fxLayout="row wrap">
                                                <legend>
                                                    <h3><b>Lote <span *ngIf="lot>0">{{lot}}</span> <span
                                                                *ngIf="lot==0">Principal</span> </b></h3>
                                                </legend>
                                                <div class="gr" fxFlex="100%" fxFlex.xs="100%">
                                                    <h3><b>Ingresos</b></h3>
                                                </div>
                                                <div class="gr" fxFlex="30%" fxFlex.xs="60%" fxFlex.sm="15%">
                                                    <mat-form-field>
                                                        <input type="number" matInput placeholder="Producto derivado"
                                                            id="prodderivado{{ac}}-{{lot}}"
                                                            formControlName="prodderivado">
                                                    </mat-form-field>
                                                </div>
                                                <div class="gr" fxFlex="30%" fxFlex.xs="30%" fxFlex.sm="35%">
                                                    <mat-form-field>
                                                        <input type="number" matInput placeholder="N animales"
                                                            id="numanimales{{ac}}-{{lot}}"
                                                            formControlName="numanimales">
                                                    </mat-form-field>
                                                </div>
                                                <div class="gr" fxFlex="50%" fxFlex.xs="30%" fxFlex.sm="25%">
                                                    <mat-form-field>
                                                        <mat-label>Unidad Venta</mat-label>
                                                        <mat-select formControlName="unidadventa"
                                                            id="unidadventa{{ac}}-{{lot}}" required>
                                                            <mat-option>--</mat-option>
                                                            <mat-option *ngFor="let un of unidades" [value]="un.id">
                                                                {{un.name}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                                <div class="gr" fxFlex="48%" fxFlex.xs="30%" fxFlex.sm="25%">
                                                    <mat-form-field>
                                                        <input type="number" matInput placeholder="Cant X animal"
                                                            id="cantidadxanimal{{ac}}-{{lot}}"
                                                            formControlName="cantidadxanimal">
                                                    </mat-form-field>
                                                </div>

                                                <div class="gr" fxFlex="30%" fxFlex.xs="25%" fxFlex.sm="25%">
                                                    <mat-form-field>
                                                        <mat-label>Frecuencia</mat-label>
                                                        <mat-select formControlName="frecuencia"
                                                            id="frecuencia{{ac}}-{{lot}}" required>
                                                            <mat-option>--</mat-option>
                                                            <mat-option *ngFor="let fre of frecuencia" [value]="fre.id">
                                                                {{fre.name}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                                <div class="gr" fxFlex="48%" fxFlex.xs="30%" fxFlex.sm="25%">
                                                    <mat-form-field>
                                                        <input type="number" matInput placeholder="Cant Producida"
                                                            id="cantproducida{{ac}}-{{lot}}"
                                                            formControlName="cantproducida">
                                                    </mat-form-field>
                                                </div>
                                                <div class="gr" fxFlex="48%" fxFlex.xs="30%" fxFlex.sm="25%">
                                                    <mat-form-field>
                                                        <input type="number" matInput placeholder="Uni Total ventas"
                                                            id="unitotalesventa{{ac}}-{{lot}}"
                                                            formControlName="unitotalesventa">
                                                    </mat-form-field>
                                                </div>
                                                <div class="gr" fxFlex="48%" fxFlex.xs="26%" fxFlex.sm="25%">
                                                    <mat-form-field>
                                                        <input type="number" matInput placeholder="%mortalidad"
                                                            id="perdida{{ac}}-{{lot}}" formControlName="perdida">
                                                    </mat-form-field>
                                                </div>
                                                <div class="gr" fxFlex="48%" fxFlex.xs="26%" fxFlex.sm="25%">
                                                    <mat-form-field>
                                                        <input type="number" matInput placeholder="preciomin"
                                                            id="preciomin{{ac}}-{{lot}}" formControlName="preciomin">
                                                    </mat-form-field>
                                                </div>
                                                <div class="gr" fxFlex="48%" fxFlex.xs="26%" fxFlex.sm="25%">
                                                    <mat-form-field>
                                                        <input type="number" matInput placeholder="precioactual"
                                                            id="precioactual{{ac}}-{{lot}}"
                                                            formControlName="precioactual">
                                                    </mat-form-field>
                                                </div>
                                                <div class="gr" fxFlex="48%" fxFlex.xs="26%" fxFlex.sm="25%">
                                                    <mat-form-field>
                                                        <input type="number" matInput placeholder="preciopromedio"
                                                            id="preciopromedio{{ac}}-{{lot}}"
                                                            formControlName="preciopromedio">
                                                    </mat-form-field>
                                                </div>
                                                <div class="gr" fxFlex="48%" fxFlex.xs="26%" fxFlex.sm="25%">
                                                    <mat-form-field>
                                                        <input type="number" matInput placeholder="ingresomes"
                                                            id="ingresomes{{ac}}-{{lot}}" formControlName="ingresomes">
                                                    </mat-form-field>
                                                </div>
                                                <div class="gr" fxFlex="40%" fxFlex.xs="27%" fxFlex.sm="35%">
                                                    <mat-form-field>
                                                        <mat-label>Mes Ingreso</mat-label>
                                                        <mat-select formControlName="mesingreso" multiple
                                                            id="mes{{ac}}-{{lot}}" required>
                                                            <mat-option *ngFor="let mes of meses" [value]="mes.id">
                                                                {{mes.name}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>

                                                <div class="gr" fxFlex="100%" fxFlex.xs="100%">
                                                    <h3><b>Egresos</b></h3>
                                                </div>
                                                <!-- Egresos  -->
                                                <mat-card class="mat-card-fases">
                                                    <mat-card-content>
                                                        <div formArrayName="egresos" class="alternate">
                                                            <div fxLayout="row wrap"
                                                                *ngFor="let egreso of egresosPecuario(ac,lot).controls; let eg=index"
                                                                class="content" [formGroupName]="eg">

                                                                <div class="gr" fxFlex="40%" fxFlex.xs="40%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <input type="text" matInput
                                                                            placeholder="descripcion"
                                                                            id="descripcion{{lot}}-{{eg}}"
                                                                            formControlName="descripcion">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="40%" fxFlex.xs="40%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <input type="text" matInput
                                                                            placeholder="detalle"
                                                                            id="detalle{{lot}}-{{eg}}"
                                                                            formControlName="detalle">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="40%" fxFlex.xs="20%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <input type="text" matInput
                                                                            placeholder="cantidad"
                                                                            id="cantidad{{lot}}-{{eg}}"
                                                                            formControlName="cantidad">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="30%" fxFlex.xs="30%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <input type="number" matInput
                                                                            placeholder="valorunitario"
                                                                            id="valorunitario{{lot}}-{{eg}}"
                                                                            formControlName="valorunitario">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="40%" fxFlex.xs="30%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <input type="number" matInput
                                                                            placeholder="total" id="total{{lot}}-{{eg}}"
                                                                            formControlName="total">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="40%" fxFlex.xs="40%"
                                                                    fxFlex.sm="35%">
                                                                    <mat-form-field>
                                                                        <mat-label>Mes</mat-label>
                                                                        <mat-select formControlName="mes" multiple
                                                                            id="mes{{lot}}-{{eg}}" required>
                                                                            <mat-option *ngFor="let mes of meses"
                                                                                [value]="mes.id">
                                                                                {{mes.name}}
                                                                            </mat-option>
                                                                        </mat-select>
                                                                    </mat-form-field>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <button mat-fab aria-label="add"
                                                            (click)="addEgresosMantenimiento(ac,lot)" mat-mini-fab
                                                            class="btnadd" type="button" color="accent">
                                                            <mat-icon>add</mat-icon>
                                                        </button>
                                                    </mat-card-content>
                                                </mat-card>


                                            </fieldset>
                                        </div>
                                    </div>
                                </div>
                            </ng-container>
                            <!-- otras actividades -->
                            <ng-container *ngSwitchDefault>
                                <mat-accordion class="example-headers-align" multi>
                                    <mat-expansion-panel>
                                        <mat-expansion-panel-header>
                                            <mat-panel-title>
                                                Cruce #1
                                            </mat-panel-title>
                                            <mat-panel-description>
                                                Ventas
                                                <mat-icon>account_balance</mat-icon>
                                            </mat-panel-description>
                                        </mat-expansion-panel-header>
                                        <!-- ventas b r m  -->
                                        <mat-card>
                                            <mat-card-header>
                                                <mat-card-title>Ventas B R M</mat-card-title>
                                            </mat-card-header>
                                            <mat-card-content>

                                                <div fxLayout="row wrap">
                                                    <div class="gr" fxFlex="100%" fxFlex.xs="100%" fxFlex.sm="100%">
                                                        <mat-radio-group formControlName="periodoventas"
                                                            aria-label="Select an option">
                                                            <mat-radio-button value="1">Dia</mat-radio-button>
                                                            <mat-radio-button value="2">Semana</mat-radio-button>
                                                            <mat-radio-button value="3">Quincena</mat-radio-button>
                                                        </mat-radio-group>
                                                    </div>

                                                    <div class="gr" fxFlex="30%" fxFlex.xs="25%" fxFlex.sm="25%">
                                                        <mat-form-field>
                                                            <mat-label>Buenas</mat-label>
                                                            <mat-select formControlName="diasB" multiple>
                                                                <mat-option *ngFor="let d of diasSemana" [value]="d.id"
                                                                    [disabled]="acti.value.diasR.indexOf(d.id) >= 0 || acti.value.diasM.indexOf(d.id) >= 0">
                                                                    {{d.name}}
                                                                </mat-option>
                                                            </mat-select>
                                                        </mat-form-field>
                                                    </div>

                                                    <div class="gr" fxFlex="30%" fxFlex.xs="25%" fxFlex.sm="25%">
                                                        <mat-form-field>
                                                            <input type="number" matInput placeholder="Valor Buenas"
                                                                id="valorB{{ac}}" formControlName="valorB">
                                                        </mat-form-field>
                                                    </div>

                                                    <div class="gr" fxFlex="30%" fxFlex.xs="25%" fxFlex.sm="25%">
                                                        <mat-form-field>
                                                            <input type="number" readonly matInput placeholder="Total"
                                                                id="totalB{{ac}}" formControlName="totalB">
                                                        </mat-form-field>
                                                    </div>
                                                    <ng-content *ngIf="acti.value.periodoventas !=2; then regulares">
                                                    </ng-content>
                                                    <ng-template #regulares>
                                                        <div class="gr" fxFlex="30%" fxFlex.xs="25%" fxFlex.sm="25%">
                                                            <mat-form-field>
                                                                <mat-label>Regulares</mat-label>
                                                                <mat-select formControlName="diasR" multiple>
                                                                    <mat-option *ngFor="let d of diasSemana"
                                                                        [disabled]="acti.value.diasB.indexOf(d.id) >= 0 || acti.value.diasM.indexOf(d.id) >= 0"
                                                                        [value]="d.id">
                                                                        {{d.name}}
                                                                    </mat-option>
                                                                </mat-select>
                                                            </mat-form-field>
                                                        </div>
                                                        <div class="gr" fxFlex="30%" fxFlex.xs="25%" fxFlex.sm="25%">
                                                            <mat-form-field>
                                                                <input type="number" matInput
                                                                    placeholder="Valor Regulares" id="valorR{{ac}}"
                                                                    formControlName="valorR">
                                                            </mat-form-field>
                                                        </div>
                                                        <div class="gr" fxFlex="30%" fxFlex.xs="25%" fxFlex.sm="25%">
                                                            <mat-form-field>
                                                                <input type="number" readonly matInput
                                                                    placeholder="Total" id="totalR{{ac}}"
                                                                    formControlName="totalR">
                                                            </mat-form-field>
                                                        </div>
                                                    </ng-template>

                                                    <div class="gr" fxFlex="30%" fxFlex.xs="25%" fxFlex.sm="25%">
                                                        <mat-form-field>
                                                            <mat-label>Malos</mat-label>
                                                            <mat-select formControlName="diasM" multiple>
                                                                <mat-option *ngFor="let d of diasSemana"
                                                                    [disabled]="acti.value.diasB.indexOf(d.id) >= 0 || acti.value.diasR.indexOf(d.id) >= 0"
                                                                    [value]="d.id">
                                                                    {{d.name}}
                                                                </mat-option>
                                                            </mat-select>
                                                        </mat-form-field>
                                                    </div>

                                                    <div class="gr" fxFlex="30%" fxFlex.xs="25%" fxFlex.sm="25%">
                                                        <mat-form-field>
                                                            <input type="number" matInput placeholder="Valor Malas"
                                                                id="valorM{{ac}}" formControlName="valorM">
                                                        </mat-form-field>
                                                    </div>

                                                    <div class="gr" fxFlex="30%" fxFlex.xs="25%" fxFlex.sm="25%">
                                                        <mat-form-field>
                                                            <input type="number" readonly matInput placeholder="Total"
                                                                id="totalM{{ac}}" formControlName="totalM">
                                                        </mat-form-field>
                                                    </div>
                                                    <div class="gr" fxFlex="30%" fxFlex.xs="30%" fxFlex.sm="25%">
                                                        <mat-form-field>
                                                            <input type="number" readonly matInput
                                                                placeholder="Promedio" id="promedio{{ac}}"
                                                                formControlName="promedio">
                                                        </mat-form-field>
                                                    </div>
                                                    <div class="gr" fxFlex="30%" fxFlex.xs="15%" fxFlex.sm="15%">
                                                        <mat-form-field>
                                                            <input type="number" matInput placeholder="Dias"
                                                                id="totalDias{{ac}}" formControlName="totalDias">
                                                        </mat-form-field>
                                                    </div>
                                                    <div class="gr" fxFlex="30%" fxFlex.xs="32%" fxFlex.sm="25%">
                                                        <mat-form-field>
                                                            <input type="number" readonly matInput
                                                                placeholder="Total Promedio" id="totalPromedio{{ac}}"
                                                                formControlName="totalPromedio">
                                                        </mat-form-field>
                                                    </div>
                                                </div>
                                            </mat-card-content>
                                        </mat-card>

                                    </mat-expansion-panel>
                                </mat-accordion>
                            </ng-container>
                        </ng-container>

                    </div>
                </mat-tab>
            </div>
        </div>

    </mat-tab-group>
    <button mat-fab type="button" class="addact" color="primary" mat-mini-fab (click)="addActividad()">
        <mat-icon>add</mat-icon>
    </button>


</form>