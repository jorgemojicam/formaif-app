<ng-template #loading>
    <div class="container-spinner">
        <mat-spinner></mat-spinner>
    </div>
</ng-template>
<ng-container *ngIf="loadData; else loading">
    <form [formGroup]="actividadesForm">

        <button mat-mini-fab type="button" class="addact" [disabled]="actividades().controls.length>=6" color="primary"
            (click)="addActividad()">
            <mat-icon>add</mat-icon>
        </button>

        <mat-tab-group mat-align-tabs="start" [selectedIndex]="selected.value"
            (selectedIndexChange)="selected.setValue($event)">
            <div formArrayName="act" fxFlex="100%">

                <mat-tab *ngFor="let acti of actividades().controls; let ac=index" label="Act {{ac}}">
                    <div [formGroupName]="ac">
                        <!-- encabezado -->
                        <div class="encabezado">
                            <mat-card>
                                <mat-card-content>
                                    <div fxLayout="row wrap">
                                        <button class="deleteact" color="warn" mat-icon-button [disabled]="ac==0"
                                            (click)="deleteAct(ac)">
                                            <mat-icon>cancel</mat-icon>
                                        </button>

                                        <div class="gr" fxFlex="30%" fxFlex.xs="30%" fxFlex.sm="30%">
                                            <mat-form-field>
                                                <mat-label>Tipo Actividad</mat-label>
                                                <mat-select formControlName="tipo" id="tipo{{ac}}" required>
                                                    <mat-option>--</mat-option>
                                                    <mat-option *ngFor="let tip of tipoActRural" [value]="tip.id">
                                                        {{tip.name}}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                        <div class="gr" fxFlex="30%" fxFlex.xs="35%" fxFlex.sm="30%">
                                            <mat-form-field class="example-full-width">
                                                <mat-label>Actividad</mat-label>
                                                <input type="text" matInput formControlName="nombre"
                                                    [matAutocomplete]="auto">
                                                <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">
                                                    <mat-option
                                                        *ngFor="let option of _filter(acti.value.nombre,acti.value.tipo,ac)"
                                                        [value]="option">
                                                        {{option.name}}
                                                    </mat-option>
                                                </mat-autocomplete>
                                            </mat-form-field>
                                        </div>
                                        <div class="gr" fxFlex="30%" fxFlex.xs="32%" fxFlex.sm="25%">
                                            <ng-container *ngIf="acti.value.tipo ==1;then tipoagro;else tipopecua">
                                            </ng-container>
                                            <ng-template #tipoagro>
                                                <mat-form-field>
                                                    <input type="text" matInput placeholder="Tipo Producción"
                                                        value="{{acti.value.nombre.tipoproducto}}"
                                                        id="tipoproduccion{{ac}}" formControlName="tipoproduccion"
                                                        readonly>
                                                </mat-form-field>
                                            </ng-template>
                                            <ng-template #tipopecua>
                                                <mat-form-field>
                                                    <mat-label>Tipo de producción</mat-label>
                                                    <mat-select formControlName="tipoproduccion"
                                                        id="tipoproduccion{{ac}}" required>
                                                        <mat-option>--</mat-option>
                                                        <mat-option *ngFor="let tip of tipoprodPecu" [value]="tip.id">
                                                            {{tip.name}}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>

                                            </ng-template>
                                        </div>
                                    </div>
                                </mat-card-content>
                                <button *ngIf="acti.value.tipo ==1" mat-fab aria-label="add" mat-mini-fab class="btnadd"
                                    type="button" [disabled]="lotes(ac).controls.length >= 6" color="accent"
                                    (click)="addLotes(ac)">
                                    <mat-icon>add</mat-icon>
                                </button>
                                <button *ngIf="acti.value.tipo ==2" mat-fab aria-label="add" mat-mini-fab class="btnadd"
                                    type="button" [disabled]="lotesPecuario(ac).controls.length >= 6" color="accent"
                                    (click)="addLotesPecuario(ac)">
                                    <mat-icon>add</mat-icon>
                                </button>
                            </mat-card>
                        </div>

                        <ng-container [ngSwitch]="acti.value.tipo">
                            <!-- agricola -->
                            <ng-container *ngSwitchCase="1">
                                <!-- Lotes agro -->
                                <div formArrayName="lotesAgro">
                                    <mat-accordion class="example-headers-align" multi>
                                        <mat-expansion-panel *ngFor="let lote of lotes(ac).controls; let lot=index"
                                            [formGroupName]="lot">
                                            <mat-expansion-panel-header>
                                                <mat-panel-title>
                                                    Lote
                                                </mat-panel-title>
                                                <mat-panel-description fxLayout="row">
                                                    <span *ngIf="lot>0"># {{lot}}</span> <span
                                                        *ngIf="lot==0">Principal</span>
                                                    <mat-icon>local_florist</mat-icon>
                                                    <button (click)="removeLotes(ac,lot)" [disabled]="lot==0"
                                                        color="warn" mat-icon-button type="button">
                                                        <mat-icon>cancel</mat-icon>
                                                    </button>
                                                </mat-panel-description>
                                            </mat-expansion-panel-header>
                                            <div fxLayout="row wrap">
                                                <div class="gr" fxFlex="30%" fxFlex.xs="33%" fxFlex.sm="35%">
                                                    <mat-form-field>
                                                        <input type="number" matInput placeholder="Edad Cultivo"
                                                            id="edadcult{{ac}}-{{lot}}" formControlName="edadcult">
                                                    </mat-form-field>
                                                </div>
                                                <div class="gr" fxFlex="30%" fxFlex.xs="33%" fxFlex.sm="25%">
                                                    <mat-form-field>
                                                        <mat-label>Edad</mat-label>
                                                        <mat-select formControlName="periodoedad"
                                                            id="periodoedad{{ac}}-{{lot}}" required>
                                                            <mat-option>--</mat-option>
                                                            <mat-option *ngFor="let ed of edadPeriodo" [value]="ed.id">
                                                                {{ed.name}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                                <div class="gr" fxFlex="30%" fxFlex.xs="33%" fxFlex.sm="15%">
                                                    <mat-form-field>
                                                        <input type="number" matInput placeholder="Area m2"
                                                            id="areacult{{ac}}-{{lot}}" formControlName="areacult">
                                                    </mat-form-field>
                                                </div>
                                                <div class="gr" fxFlex="100%" fxFlex.xs="100%" fxFlex.sm="25%">
                                                    <mat-card class="cardlote">
                                                        <mat-card-content>
                                                            <mat-slide-toggle formControlName="aplicadiastancia">
                                                                Distancia de siembra
                                                            </mat-slide-toggle>
                                                        </mat-card-content>
                                                    </mat-card>
                                                </div>
                                                <br>
                                                <ng-container *ngIf="lote.value.aplicadiastancia">
                                                    <div class="gr" fxFlex="100%" fxFlex.xs="100%" fxFlex.sm="25%">
                                                        <mat-card class="cardlote">
                                                            <mat-card-content>
                                                                <div class="gr" fxFlex="33%" fxFlex.xs="33%"
                                                                    fxFlex.sm="100%">
                                                                    <mat-form-field>
                                                                        <input type="tel" matInput
                                                                            placeholder="D. entre surcos"
                                                                            id="dsurcos{{ac}}-{{lot}}"
                                                                            formControlName="dsurcos">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="33%" fxFlex.xs="33%"
                                                                    fxFlex.sm="100%">
                                                                    <mat-form-field>
                                                                        <input type="tel" matInput
                                                                            placeholder="D. entre plantas"
                                                                            id="dplantas{{ac}}-{{lot}}"
                                                                            formControlName="dplantas">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="33%" fxFlex.xs="33%"
                                                                    fxFlex.sm="100%">
                                                                    <mat-form-field>
                                                                        <input type="text" readonly matInput
                                                                            placeholder="Densidad"
                                                                            id="diastancia{{ac}}-{{lot}}"
                                                                            formControlName="diastancia">
                                                                    </mat-form-field>
                                                                </div>
                                                            </mat-card-content>
                                                        </mat-card>
                                                    </div>
                                                </ng-container>
                                                <br>
                                                <div class="gr" fxFlex="100%" fxFlex.xs="100%" fxFlex.sm="25%">
                                                    <mat-card class="cardlote">
                                                        <mat-card-content>
                                                            <mat-slide-toggle formControlName="aplicaplantasinformacli">
                                                                #plantas/semillas del lote
                                                            </mat-slide-toggle>
                                                        </mat-card-content>
                                                    </mat-card>
                                                </div>
                                                <ng-container *ngIf="lote.value.aplicaplantasinformacli">
                                                    <div class="gr" fxFlex="100%" fxFlex.xs="100%" fxFlex.sm="100%">
                                                        <mat-form-field>
                                                            <input type="number" matInput placeholder="#plantas"
                                                                id="planatasinformacli{{ac}}-{{lot}}"
                                                                formControlName="planatasinformacli">
                                                        </mat-form-field>
                                                    </div>
                                                </ng-container>
                                                <div class="gr" fxFlex="100%" fxFlex.xs="100%" fxFlex.sm="100%">
                                                    <mat-form-field>
                                                        <mat-label>Unidad Venta</mat-label>
                                                        <mat-select formControlName="unidadventa"
                                                            id="unidadventa{{ac}}-{{lot}}" required>
                                                            <mat-option>--</mat-option>
                                                            <mat-option *ngFor="let un of unidades" [value]="un.id">
                                                                {{un.name}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                                <ng-container
                                                    *ngIf="acti.value.nombre.tipoproducto=='Transitorio';then transitoria;else permanentes">
                                                </ng-container>
                                                <!-- transitorio -->
                                                <ng-template #transitoria>
                                                    <div class="gr" fxFlex="100%" fxFlex.xs="100%">
                                                        <div class="titulo">
                                                            <h3><b>Ingresos</b> </h3>
                                                        </div>
                                                        <mat-chip-list class="chip-titulo">
                                                            <mat-chip color="accent" selected>
                                                                $ {{lote.value.totalIngreso}}
                                                            </mat-chip>
                                                        </mat-chip-list>
                                                    </div>
                                                    <div fxLayout="row wrap" class="contentingresos">
                                                        <div class="gr" fxFlex="30%" fxFlex.xs="32%" fxFlex.sm="25%">
                                                            <mat-form-field>
                                                                <input type="tel" matInput
                                                                    placeholder="Rendimiento por lote"
                                                                    id="rendiemientolote{{ac}}-{{lot}}"
                                                                    formControlName="rendiemientolote">
                                                            </mat-form-field>
                                                        </div>
                                                        <div class="gr" fxFlex="30%" fxFlex.xs="32%" fxFlex.sm="25%">
                                                            <mat-form-field>
                                                                <input type="tel" matInput
                                                                    placeholder="Unidades totales"
                                                                    id="unidadestotales{{ac}}-{{lot}}"
                                                                    formControlName="unidadestotales">
                                                            </mat-form-field>
                                                        </div>
                                                        <div class="gr" fxFlex="30%" fxFlex.xs="30%" fxFlex.sm="25%">
                                                            <mat-form-field>
                                                                <input type="tel" matInput placeholder="% Perdida"
                                                                    id="perdida{{ac}}-{{lot}}"
                                                                    formControlName="perdida">
                                                            </mat-form-field>
                                                        </div>
                                                        <div class="gr" fxFlex="30%" fxFlex.xs="32%" fxFlex.sm="28%">
                                                            <mat-form-field>
                                                                <input type="tel" matInput placeholder="Precio Min"
                                                                    id="preciomin{{ac}}-{{lot}}"
                                                                    formControlName="preciomin">
                                                            </mat-form-field>
                                                        </div>
                                                        <div class="gr" fxFlex="30%" fxFlex.xs="33%" fxFlex.sm="28%">
                                                            <mat-form-field>
                                                                <input type="tel" matInput placeholder="Precio Actual"
                                                                    id="precioactual{{ac}}-{{lot}}"
                                                                    formControlName="precioactual">
                                                            </mat-form-field>
                                                        </div>

                                                        <div class="gr" fxFlex="30%" fxFlex.xs="30%" fxFlex.sm="25%">
                                                            <mat-form-field>
                                                                <input type="text" matInput
                                                                    placeholder="Precio Promedio" readonly
                                                                    id="preciopromedio{{ac}}-{{lot}}"
                                                                    formControlName="preciopromedio">
                                                            </mat-form-field>
                                                        </div>
                                                        <div class="gr" fxFlex="10%" fxFlex.xs="100%" fxFlex.sm="100%">
                                                            <mat-form-field>
                                                                <mat-label>Cosecha</mat-label>
                                                                <mat-select formControlName="cocecha" multiple
                                                                    id="cocecha{{ac}}-{{lot}}" required>
                                                                    <mat-option *ngFor="let mes of meses"
                                                                        [value]="mes.id">
                                                                        {{mes.name}}
                                                                    </mat-option>
                                                                </mat-select>
                                                            </mat-form-field>
                                                        </div>
                                                    </div>
                                                </ng-template>
                                                <!-- permanente -->
                                                <ng-template #permanentes>
                                                    <div class="gr" fxFlex="100%" fxFlex.xs="100%">
                                                        <div class="titulo">
                                                            <h3><b>Ingresos</b> </h3>
                                                        </div>
                                                        <mat-chip-list class="chip-titulo">
                                                            <mat-chip color="accent" selected>
                                                                $ {{lote.value.totalLoteAunual}}
                                                            </mat-chip>
                                                        </mat-chip-list>
                                                    </div>
                                                    <div fxLayout="row wrap" class="content">
                                                        <div class="gr" fxFlex="30%" fxFlex.xs="33%" fxFlex.sm="28%">
                                                            <mat-form-field>
                                                                <input type="tel" matInput placeholder="Precio Min"
                                                                    id="preciomin{{ac}}-{{lot}}"
                                                                    formControlName="preciomin">
                                                            </mat-form-field>
                                                        </div>
                                                        <div class="gr" fxFlex="30%" fxFlex.xs="33%" fxFlex.sm="28%">
                                                            <mat-form-field>
                                                                <input type="tel" matInput placeholder="Precio Actual"
                                                                    id="precioactual{{ac}}-{{lot}}"
                                                                    formControlName="precioactual">
                                                            </mat-form-field>
                                                        </div>
                                                        <div class="gr" fxFlex="30%" fxFlex.xs="30%" fxFlex.sm="25%">
                                                            <mat-form-field>
                                                                <input type="tel" matInput placeholder="Precio Promedio"
                                                                    readonly id="preciopromedio{{ac}}-{{lot}}"
                                                                    formControlName="preciopromedio">
                                                            </mat-form-field>
                                                        </div>
                                                    </div>
                                                    <mat-vertical-stepper linear="true" #stepper>
                                                        <mat-step state="check">
                                                            <div fxLayout="row wrap">
                                                                <ng-template matStepLabel>Cosecha <span
                                                                        class="totalstep"> {{lote.value.procentageCos}}
                                                                        %</span>
                                                                </ng-template>
                                                                <div class="gr" fxFlex="20%" fxFlex.xs="40%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <mat-label>Rendimiento</mat-label>
                                                                        <input matInput type="tel"
                                                                            placeholder="Rendimiento"
                                                                            formControlName="rendimientoCos">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="20%" fxFlex.xs="40%"
                                                                    fxFlex.sm="35%">
                                                                    <mat-form-field>
                                                                        <mat-label>Cosecha</mat-label>
                                                                        <mat-select formControlName="mesCos" multiple
                                                                            id="mesCos{{ac}}-{{lot}}" required>
                                                                            <mat-option *ngFor="let mes of meses"
                                                                                [disabled]="lote.value.mesTra.indexOf(mes.id) >= 0 || lote.value.mesPepeo.indexOf(mes.id) >= 0"
                                                                                [value]="mes.id">
                                                                                {{mes.name}}
                                                                            </mat-option>
                                                                        </mat-select>
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="20%" fxFlex.xs="40%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <mat-label>Unidades Venta
                                                                        </mat-label>
                                                                        <input matInput type="tel"
                                                                            placeholder="Unidades"
                                                                            formControlName="unidadesCos">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="15%" fxFlex.xs="40%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <mat-label>%Perdida</mat-label>
                                                                        <input matInput type="tel" readonly
                                                                            placeholder="Perdida"
                                                                            formControlName="perdidaCos">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="100%" fxFlex.xs="100%"
                                                                    fxFlex.sm="100%">
                                                                    <mat-form-field appearance="outline">
                                                                        <mat-label>Total Cosecha</mat-label>
                                                                        <input matInput type="text" placeholder="Total"
                                                                            formControlName="totalCos" readonly
                                                                            id="totalCos-{{ac}}-{{lot}}">
                                                                        <mat-icon matSuffix>attach_money</mat-icon>
                                                                    </mat-form-field>
                                                                </div>

                                                                <div>
                                                                    <button mat-button color="primary"
                                                                        matStepperNext>Siguiente</button>
                                                                </div>
                                                            </div>
                                                        </mat-step>
                                                        <mat-step>
                                                            <div fxLayout="row wrap">
                                                                <ng-template matStepLabel>Traviesa <span
                                                                        class="totalstep"> {{lote.value.procentageTra}}
                                                                        %</span>
                                                                </ng-template>
                                                                <div class="gr" fxFlex="30%" fxFlex.xs="40%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <mat-label>Rendimiento</mat-label>
                                                                        <input type="tel" matInput
                                                                            placeholder="Rendimiento"
                                                                            formControlName="rendimientoTra">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="40%" fxFlex.xs="40%"
                                                                    fxFlex.sm="35%">
                                                                    <mat-form-field>
                                                                        <mat-label>Traviesa</mat-label>
                                                                        <mat-select formControlName="mesTra" multiple
                                                                            id="mesTra{{ac}}-{{lot}}" required>
                                                                            <mat-option *ngFor="let mes of meses"
                                                                                [disabled]="lote.value.mesCos.indexOf(mes.id) >= 0 || lote.value.mesPepeo.indexOf(mes.id) >= 0"
                                                                                [value]="mes.id">
                                                                                {{mes.name}}
                                                                            </mat-option>
                                                                        </mat-select>
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="30%" fxFlex.xs="40%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <mat-label>Unidades Venta
                                                                        </mat-label>
                                                                        <input type="tel" matInput
                                                                            placeholder="Unidades"
                                                                            formControlName="unidadesTra">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="30%" fxFlex.xs="40%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <mat-label>%Perdida</mat-label>
                                                                        <input type="tel" matInput placeholder="Perdida"
                                                                            formControlName="perdidaTra">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="100%" fxFlex.xs="100%"
                                                                    fxFlex.sm="100%">
                                                                    <mat-form-field appearance="outline">
                                                                        <mat-label>Total Traviesa</mat-label>
                                                                        <input matInput type="text" placeholder="Total"
                                                                            formControlName="totalTra" readonly
                                                                            id="totalTra-{{ac}}-{{lot}}">
                                                                        <mat-icon matSuffix>attach_money</mat-icon>
                                                                    </mat-form-field>
                                                                </div>
                                                                <div>
                                                                    <button mat-button color="primary"
                                                                        matStepperPrevious>Atras</button>
                                                                    <button mat-button color="primary"
                                                                        matStepperNext>Siguiente</button>
                                                                </div>
                                                            </div>
                                                        </mat-step>
                                                        <mat-step>
                                                            <div fxLayout="row wrap">
                                                                <ng-template matStepLabel>Pepeo <span class="totalstep">
                                                                        {{lote.value.procentagePepeo}} %</span>
                                                                </ng-template>
                                                                <div class="gr" fxFlex="30%" fxFlex.xs="40%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <mat-label>Rendimiento</mat-label>
                                                                        <input matInput type="tel"
                                                                            placeholder="Rendimiento"
                                                                            formControlName="rendimientoPepeo">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="40%" fxFlex.xs="40%"
                                                                    fxFlex.sm="35%">
                                                                    <mat-form-field>
                                                                        <mat-label>Traviesa</mat-label>
                                                                        <mat-select formControlName="mesPepeo" multiple
                                                                            id="mesPepeo{{ac}}-{{lot}}" required>
                                                                            <mat-option *ngFor="let mes of meses"
                                                                                [disabled]="lote.value.mesCos.indexOf(mes.id) >= 0 || lote.value.mesTra.indexOf(mes.id) >= 0"
                                                                                [value]="mes.id">
                                                                                {{mes.name}}
                                                                            </mat-option>
                                                                        </mat-select>
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="30%" fxFlex.xs="40%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <mat-label>Unidades Venta
                                                                        </mat-label>
                                                                        <input matInput placeholder="Unidades"
                                                                            type="tel" formControlName="unidadesPepeo">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="30%" fxFlex.xs="40%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <mat-label>%Perdida</mat-label>
                                                                        <input matInput placeholder="Perdida" type="tel"
                                                                            formControlName="perdidaPepeo">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="100%" fxFlex.xs="100%"
                                                                    fxFlex.sm="100%">
                                                                    <mat-form-field appearance="outline">
                                                                        <mat-label>Total Pepeo</mat-label>
                                                                        <input matInput type="text" placeholder="Total"
                                                                            formControlName="totalPepeo" readonly
                                                                            id="totalPepeo-{{ac}}-{{lot}}">
                                                                        <mat-icon matSuffix>attach_money</mat-icon>
                                                                    </mat-form-field>
                                                                </div>

                                                                <p>Informacion completada.</p>
                                                            </div>
                                                        </mat-step>
                                                    </mat-vertical-stepper>
                                                    <div class="gr" fxFlex="100%" fxFlex.xs="100%" fxFlex.sm="100%">
                                                        <mat-form-field appearance="outline">
                                                            <mat-label>Unidades Totales</mat-label>
                                                            <input matInput type="text" placeholder="Porcentaje"
                                                                formControlName="totalUnidades" readonly
                                                                id="totalUnidades-{{ac}}-{{lot}}">
                                                        </mat-form-field>
                                                    </div>
                                                </ng-template>
                                                <ng-container
                                                    *ngIf="acti.value.nombre.tipoproducto=='Transitorio';then egresotransitorio;else egresopermanente">
                                                </ng-container>
                                                <ng-template #egresotransitorio>
                                                    <div class="titulo">
                                                        <h3><b>Egresos</b></h3>
                                                    </div>
                                                    <mat-chip-list class="chip-titulo">
                                                        <mat-chip color="accent" selected>
                                                            $ {{lote.value.totalEgresos}}
                                                        </mat-chip>
                                                    </mat-chip-list>
                                                    <!-- fase adecuacion -->
                                                    <mat-card class="mat-card-fases">
                                                        <h3>Fase Adecuación</h3>
                                                        <mat-chip-list class="pull-right">
                                                            <mat-chip>
                                                                $ {{lote.value.totalEgresosAdecuacion}}
                                                            </mat-chip>
                                                        </mat-chip-list>
                                                        <mat-card-content>
                                                            <div formArrayName="egresosAdecuacion" class="alternate">
                                                                <div *ngFor="let egreso of egresadosAdecuacion(ac,lot).controls; let eg=index"
                                                                    [formGroupName]="eg" class="content">
                                                                    <div fxLayout="row wrap">
                                                                        <div class="gr" fxFlex="20%" fxFlex.xs="45%"
                                                                            fxFlex.sm="35%">
                                                                            <mat-form-field>
                                                                                <mat-label>Descripción</mat-label>
                                                                                <mat-select
                                                                                    formControlName="descripcion"
                                                                                    id="descripcion{{ac}}-{{lot}}"
                                                                                    required>
                                                                                    <mat-option
                                                                                        *ngFor="let det of detalleagri"
                                                                                        [value]="det.id">
                                                                                        {{det.name}}
                                                                                    </mat-option>
                                                                                </mat-select>
                                                                            </mat-form-field>
                                                                        </div>
                                                                        <div class="gr" fxFlex="40%" fxFlex.xs="50%"
                                                                            fxFlex.sm="25%">
                                                                            <mat-form-field>
                                                                                <input type="text" matInput
                                                                                    placeholder="Detalle"
                                                                                    id="detalle{{lot}}-{{eg}}"
                                                                                    formControlName="detalle">
                                                                            </mat-form-field>
                                                                        </div>

                                                                        <div class="gr" fxFlex="40%" fxFlex.xs="25%"
                                                                            fxFlex.sm="25%">
                                                                            <mat-form-field>
                                                                                <input type="number" matInput
                                                                                    placeholder="Cantidad"
                                                                                    id="cantidad{{lot}}-{{eg}}"
                                                                                    formControlName="cantidad">
                                                                            </mat-form-field>
                                                                        </div>
                                                                        <div class="gr" fxFlex="30%" fxFlex.xs="37%"
                                                                            fxFlex.sm="25%">
                                                                            <mat-form-field>
                                                                                <input type="tel" matInput
                                                                                    placeholder="Valor Unitario"
                                                                                    id="valorunitario{{lot}}-{{eg}}"
                                                                                    formControlName="valorunitario">
                                                                            </mat-form-field>
                                                                        </div>
                                                                        <div class="gr" fxFlex="40%" fxFlex.xs="37%"
                                                                            fxFlex.sm="25%">
                                                                            <mat-form-field>
                                                                                <input type="tel" matInput readonly
                                                                                    placeholder="Total"
                                                                                    id="total{{lot}}-{{eg}}"
                                                                                    formControlName="total">
                                                                            </mat-form-field>
                                                                        </div>
                                                                        <div class="gr" fxFlex="100%" fxFlex.xs="100%"
                                                                            fxFlex.sm="35%">
                                                                            <mat-form-field>
                                                                                <mat-label>Mes</mat-label>
                                                                                <mat-select formControlName="mes"
                                                                                    multiple id="mes{{lot}}-{{eg}}"
                                                                                    required>
                                                                                    <mat-option
                                                                                        *ngFor="let mes of meses"
                                                                                        [value]="mes.id">
                                                                                        {{mes.name}}
                                                                                    </mat-option>
                                                                                </mat-select>
                                                                            </mat-form-field>
                                                                        </div>

                                                                        <button class="btndelete" color="warn"
                                                                            mat-icon-button [disabled]="eg ==0"
                                                                            (click)="removeEgresosAdecuacion(ac,lot,eg)">
                                                                            <mat-icon>cancel</mat-icon>
                                                                        </button>

                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <button mat-fab aria-label="add"
                                                                (click)="addEgresosAdecuacion(ac,lot)" mat-mini-fab
                                                                class="btnadd" type="button" color="accent">
                                                                <mat-icon>add</mat-icon>
                                                            </button>
                                                        </mat-card-content>
                                                    </mat-card>
                                                    <!-- Fase Siembra -->
                                                    <mat-card class="mat-card-fases">
                                                        <h3>Fase Siembra</h3>
                                                        <mat-chip-list class="pull-right">
                                                            <mat-chip>
                                                                $ {{lote.value.totalEgresosSiembre}}
                                                            </mat-chip>
                                                        </mat-chip-list>
                                                        <mat-card-content>
                                                            <div formArrayName="egresosSiembra" class="alternate">
                                                                <div *ngFor="let egreso of egresadosSiembra(ac,lot).controls; let eg=index"
                                                                    [formGroupName]="eg" class="content">
                                                                    <div fxLayout="row wrap">
                                                                        <div class="gr" fxFlex="20%" fxFlex.xs="45%"
                                                                            fxFlex.sm="35%">
                                                                            <mat-form-field>
                                                                                <mat-label>Descripción</mat-label>
                                                                                <mat-select
                                                                                    formControlName="descripcion"
                                                                                    id="descripcion{{ac}}-{{lot}}"
                                                                                    required>
                                                                                    <mat-option
                                                                                        *ngFor="let det of detalleagri"
                                                                                        [value]="det.id">
                                                                                        {{det.name}}
                                                                                    </mat-option>
                                                                                </mat-select>
                                                                            </mat-form-field>
                                                                        </div>
                                                                        <div class="gr" fxFlex="40%" fxFlex.xs="50%"
                                                                            fxFlex.sm="25%">
                                                                            <mat-form-field>
                                                                                <input type="text" matInput
                                                                                    placeholder="Detalle"
                                                                                    id="detalle{{lot}}-{{eg}}"
                                                                                    formControlName="detalle">
                                                                            </mat-form-field>
                                                                        </div>

                                                                        <div class="gr" fxFlex="40%" fxFlex.xs="25%"
                                                                            fxFlex.sm="25%">
                                                                            <mat-form-field>
                                                                                <input type="number" matInput
                                                                                    placeholder="Cantidad"
                                                                                    id="cantidad{{lot}}-{{eg}}"
                                                                                    formControlName="cantidad">
                                                                            </mat-form-field>
                                                                        </div>
                                                                        <div class="gr" fxFlex="30%" fxFlex.xs="37%"
                                                                            fxFlex.sm="25%">
                                                                            <mat-form-field>
                                                                                <input type="tel" matInput
                                                                                    placeholder="Valor Unitario"
                                                                                    id="valorunitario{{lot}}-{{eg}}"
                                                                                    formControlName="valorunitario">
                                                                            </mat-form-field>
                                                                        </div>
                                                                        <div class="gr" fxFlex="40%" fxFlex.xs="37%"
                                                                            fxFlex.sm="25%">
                                                                            <mat-form-field>
                                                                                <input type="tel" matInput readonly
                                                                                    placeholder="Total"
                                                                                    id="total{{lot}}-{{eg}}"
                                                                                    formControlName="total">
                                                                            </mat-form-field>
                                                                        </div>
                                                                        <div class="gr" fxFlex="100%" fxFlex.xs="100%"
                                                                            fxFlex.sm="35%">
                                                                            <mat-form-field>
                                                                                <mat-label>Mes</mat-label>
                                                                                <mat-select formControlName="mes"
                                                                                    multiple id="mes{{lot}}-{{eg}}"
                                                                                    required>
                                                                                    <mat-option
                                                                                        *ngFor="let mes of meses"
                                                                                        [value]="mes.id">
                                                                                        {{mes.name}}
                                                                                    </mat-option>
                                                                                </mat-select>
                                                                            </mat-form-field>
                                                                        </div>
                                                                        <button type="button" class="btndelete"
                                                                            color="warn" mat-icon-button
                                                                            [disabled]="eg ==0"
                                                                            (click)="removeEgresosSiembra(ac,lot,eg)">
                                                                            <mat-icon>cancel</mat-icon>
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <button mat-fab aria-label="add"
                                                                (click)="addEgresosSiembra(ac,lot)" mat-mini-fab
                                                                class="btnadd" type="button" color="accent">
                                                                <mat-icon>add</mat-icon>
                                                            </button>
                                                        </mat-card-content>
                                                    </mat-card>
                                                </ng-template>
                                                <ng-template #egresopermanente>
                                                    <div class="titulo">
                                                        <h3><b>Egresos</b></h3>
                                                    </div>
                                                    <mat-chip-list class="chip-titulo">
                                                        <mat-chip color="accent" selected>
                                                            $ {{lote.value.totalEgresos}}
                                                        </mat-chip>
                                                    </mat-chip-list>
                                                </ng-template>
                                                <!-- fase mantenimiento -->
                                                <mat-card class="mat-card-fases">
                                                    <h3>Fase Mantenimiento</h3>
                                                    <mat-chip-list class="pull-right">
                                                        <mat-chip>
                                                            $ {{lote.value.totalEgresosMante}}
                                                        </mat-chip>
                                                    </mat-chip-list>
                                                    <mat-card-content>
                                                        <div formArrayName="egresosMante" class="alternate">
                                                            <div fxLayout="row wrap"
                                                                *ngFor="let egreso of egresadosMante(ac,lot).controls; let eg=index"
                                                                class="content" [formGroupName]="eg">
                                                                <div class="gr" fxFlex="20%" fxFlex.xs="45%"
                                                                    fxFlex.sm="35%">
                                                                    <mat-form-field>
                                                                        <mat-label>Descripción</mat-label>
                                                                        <mat-select formControlName="descripcion"
                                                                            id="descripcion{{ac}}-{{lot}}" required>
                                                                            <mat-option *ngFor="let det of detalleagri"
                                                                                [value]="det.id">
                                                                                {{det.name}}
                                                                            </mat-option>
                                                                        </mat-select>
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="40%" fxFlex.xs="50%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <input type="text" matInput
                                                                            placeholder="Detalle"
                                                                            id="detalle{{lot}}-{{eg}}"
                                                                            formControlName="detalle">
                                                                    </mat-form-field>
                                                                </div>

                                                                <div class="gr" fxFlex="40%" fxFlex.xs="25%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <input type="number" matInput
                                                                            placeholder="Cantidad"
                                                                            id="cantidad{{lot}}-{{eg}}"
                                                                            formControlName="cantidad">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="30%" fxFlex.xs="37%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <input type="tel" matInput
                                                                            placeholder="Valor Unitario"
                                                                            id="valorunitario{{lot}}-{{eg}}"
                                                                            formControlName="valorunitario">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="40%" fxFlex.xs="37%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <input type="tel" matInput readonly
                                                                            placeholder="Total" id="total{{lot}}-{{eg}}"
                                                                            formControlName="total">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="100%" fxFlex.xs="100%"
                                                                    fxFlex.sm="35%">
                                                                    <mat-form-field>
                                                                        <mat-label>Mes</mat-label>
                                                                        <mat-select formControlName="mes" multiple
                                                                            id="mes{{lot}}-{{eg}}" required>
                                                                            <mat-option *ngFor="let mes of meses"
                                                                                [value]="mes.id">
                                                                                {{mes.name}}
                                                                            </mat-option>
                                                                        </mat-select>
                                                                    </mat-form-field>
                                                                </div>
                                                                <button type="button" class="btndelete" color="warn"
                                                                    mat-icon-button [disabled]="eg ==0"
                                                                    (click)="removeEgresosmantenimiento(ac,lot,eg)">
                                                                    <mat-icon>cancel</mat-icon>
                                                                </button>
                                                            </div>
                                                        </div>
                                                        <button mat-fab aria-label="add"
                                                            (click)="addEgresosMantenimiento(ac,lot)" mat-mini-fab
                                                            class="btnadd" type="button" color="accent">
                                                            <mat-icon>add</mat-icon>
                                                        </button>
                                                    </mat-card-content>
                                                </mat-card>
                                                <!-- fase Cocecha -->
                                                <mat-card class="mat-card-fases">
                                                    <h3>Fase Cosecha</h3>
                                                    <mat-chip-list class="pull-right">
                                                        <mat-chip>
                                                            $ {{lote.value.totalEgresosCosecha}}
                                                        </mat-chip>
                                                    </mat-chip-list>
                                                    <mat-card-content>
                                                        <div formArrayName="egresosCocecha" class="alternate">
                                                            <div fxLayout="row wrap"
                                                                *ngFor="let egreso of egresadosCocecha(ac,lot).controls; let eg=index"
                                                                class="content" [formGroupName]="eg">

                                                                <div class="gr" fxFlex="20%" fxFlex.xs="45%"
                                                                    fxFlex.sm="35%">
                                                                    <mat-form-field>
                                                                        <mat-label>Descripción</mat-label>
                                                                        <mat-select formControlName="descripcion"
                                                                            id="descripcion{{ac}}-{{lot}}" required>
                                                                            <mat-option *ngFor="let det of detalleagri"
                                                                                [value]="det.id">
                                                                                {{det.name}}
                                                                            </mat-option>
                                                                        </mat-select>
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="40%" fxFlex.xs="50%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <input type="text" matInput
                                                                            placeholder="Detalle"
                                                                            id="detalle{{lot}}-{{eg}}"
                                                                            formControlName="detalle">
                                                                    </mat-form-field>
                                                                </div>

                                                                <div class="gr" fxFlex="40%" fxFlex.xs="25%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <input type="number" matInput
                                                                            placeholder="Cantidad"
                                                                            id="cantidad{{lot}}-{{eg}}"
                                                                            formControlName="cantidad">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="30%" fxFlex.xs="37%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <input type="tel" matInput
                                                                            placeholder="Valor Unitario"
                                                                            id="valorunitario{{lot}}-{{eg}}"
                                                                            formControlName="valorunitario">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="40%" fxFlex.xs="37%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <input type="tel" matInput readonly
                                                                            placeholder="Total" id="total{{lot}}-{{eg}}"
                                                                            formControlName="total">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="100%" fxFlex.xs="100%"
                                                                    fxFlex.sm="35%">
                                                                    <mat-form-field>
                                                                        <mat-label>Mes</mat-label>
                                                                        <mat-select formControlName="mes" multiple
                                                                            id="mes{{lot}}-{{eg}}" required>
                                                                            <mat-option *ngFor="let mes of meses"
                                                                                [value]="mes.id">
                                                                                {{mes.name}}
                                                                            </mat-option>
                                                                        </mat-select>
                                                                    </mat-form-field>
                                                                </div>
                                                                <button type="button" class="btndelete" color="warn"
                                                                    mat-icon-button [disabled]="eg ==0"
                                                                    (click)="removeEgresosCosecha(ac,lot,eg)">
                                                                    <mat-icon>cancel</mat-icon>
                                                                </button>
                                                            </div>
                                                        </div>
                                                        <button mat-fab aria-label="add"
                                                            (click)="addEgresosCocecho(ac,lot)" mat-mini-fab
                                                            class="btnadd" type="button" color="accent">
                                                            <mat-icon>add</mat-icon>
                                                        </button>
                                                    </mat-card-content>
                                                </mat-card>
                                            </div>
                                        </mat-expansion-panel>
                                    </mat-accordion>
                                </div>
                            </ng-container>
                            <!-- pecuario -->
                            <ng-container *ngSwitchCase="2">
                                <div formArrayName="lotesPecuario">
                                    <mat-accordion class="example-headers-align" multi>
                                        <mat-expansion-panel
                                            *ngFor="let lote of lotesPecuario(ac).controls; let lot=index"
                                            [formGroupName]="lot">
                                            <mat-expansion-panel-header>
                                                <mat-panel-title>
                                                    Lote
                                                </mat-panel-title>
                                                <mat-panel-description fxLayout="row">
                                                    <span *ngIf="lot>0"># {{lot}}</span> <span
                                                        *ngIf="lot==0">Principal</span>
                                                    <mat-icon>pets</mat-icon>
                                                    <button (click)="removeLotesPecuario(ac,lot)" [disabled]="lot==0"
                                                        color="warn" mat-icon-button type="button">
                                                        <mat-icon>cancel</mat-icon>
                                                    </button>
                                                </mat-panel-description>
                                            </mat-expansion-panel-header>

                                            <div fxLayout="row wrap">
                                                <mat-card class="mat-card-fases">
                                                    <mat-card-header>
                                                        <mat-card-title>Ingresos</mat-card-title>
                                                        <mat-chip-list class="pull-right">
                                                            <mat-chip color="accent" selected>
                                                                $ {{lote.value.ingresomes}}
                                                            </mat-chip>
                                                        </mat-chip-list>
                                                    </mat-card-header>
                                                    <mat-card-content>
                                                        <div fxLayout="row wrap">
                                                            <div class="gr" fxFlex="30%" fxFlex.xs="60%"
                                                                fxFlex.sm="15%">
                                                                <mat-form-field>
                                                                    <input type="text" matInput
                                                                        placeholder="Producto derivado"
                                                                        id="prodderivado{{ac}}-{{lot}}"
                                                                        formControlName="prodderivado">
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="gr" fxFlex="30%" fxFlex.xs="40%"
                                                                fxFlex.sm="35%">
                                                                <mat-form-field>
                                                                    <input type="number" matInput
                                                                        placeholder="N° animales"
                                                                        id="numanimales{{ac}}-{{lot}}"
                                                                        formControlName="numanimales">
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="gr" fxFlex="50%" fxFlex.xs="30%"
                                                                fxFlex.sm="25%">
                                                                <mat-form-field>
                                                                    <mat-label>Unidad Venta</mat-label>
                                                                    <mat-select formControlName="unidadventa" id="unidadventa{{ac}}-{{lot}}" required>
                                                                        <mat-option>--</mat-option>
                                                                        <mat-option *ngFor="let un of unidades" [value]="un.id" [disabled]="un.id ==5">
                                                                            {{un.name}}
                                                                        </mat-option>
                                                                    </mat-select>
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="gr" fxFlex="48%" fxFlex.xs="30%"
                                                                fxFlex.sm="25%">
                                                                <mat-form-field>
                                                                    <input type="number" matInput
                                                                        placeholder="Cant por animal"
                                                                        id="cantidadxanimal{{ac}}-{{lot}}"
                                                                        formControlName="cantidadxanimal">
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="gr" fxFlex="30%" fxFlex.xs="40%"
                                                                fxFlex.sm="25%">
                                                                <mat-form-field>
                                                                    <mat-label>Frecuencia</mat-label>
                                                                    <mat-select formControlName="frecuencia"
                                                                        id="frecuencia{{ac}}-{{lot}}" required>
                                                                        <mat-option>--</mat-option>
                                                                        <mat-option *ngFor="let fre of frecuencia"
                                                                            [value]="fre">
                                                                            {{fre.name}}
                                                                        </mat-option>
                                                                    </mat-select>
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="gr" fxFlex="48%" fxFlex.xs="33%"
                                                                fxFlex.sm="25%">
                                                                <mat-form-field>
                                                                    <input type="tel" matInput
                                                                        placeholder="Cant Producida"
                                                                        id="cantproducida{{ac}}-{{lot}}" readonly
                                                                        formControlName="cantproducida">
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="gr" fxFlex="48%" fxFlex.xs="33%"
                                                                fxFlex.sm="25%">
                                                                <mat-form-field>
                                                                    <input type="tel" matInput
                                                                        placeholder="Uni Total ventas"
                                                                        id="unitotalesventa{{ac}}-{{lot}}"
                                                                        formControlName="unitotalesventa">
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="gr" fxFlex="48%" fxFlex.xs="33%"
                                                                fxFlex.sm="25%">
                                                                <mat-form-field>
                                                                    <input type="text" matInput
                                                                        placeholder="% Mortalidad" readonly
                                                                        id="perdida{{ac}}-{{lot}}"
                                                                        formControlName="perdida">
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="gr" fxFlex="48%" fxFlex.xs="33%"
                                                                fxFlex.sm="25%">
                                                                <mat-form-field>
                                                                    <input type="tel" matInput
                                                                        placeholder="Precio mínimo"
                                                                        id="preciomin{{ac}}-{{lot}}"
                                                                        formControlName="preciomin">
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="gr" fxFlex="48%" fxFlex.xs="33%"
                                                                fxFlex.sm="25%">
                                                                <mat-form-field>
                                                                    <input type="tel" matInput
                                                                        placeholder="Precio actual"
                                                                        id="precioactual{{ac}}-{{lot}}"
                                                                        formControlName="precioactual">
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="gr" fxFlex="48%" fxFlex.xs="33%"
                                                                fxFlex.sm="25%">
                                                                <mat-form-field>
                                                                    <input type="tel" matInput
                                                                        placeholder="Precio promedio"
                                                                        id="preciopromedio{{ac}}-{{lot}}" readonly
                                                                        formControlName="preciopromedio">
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="gr" fxFlex="100%" fxFlex.xs="100%"
                                                                fxFlex.sm="100%">
                                                                <mat-form-field>
                                                                    <mat-label>Mes Ingreso</mat-label>
                                                                    <mat-select formControlName="mesingreso" multiple
                                                                        id="mes{{ac}}-{{lot}}" required>
                                                                        <mat-option *ngFor="let mes of meses"
                                                                            [value]="mes.id">
                                                                            {{mes.name}}
                                                                        </mat-option>
                                                                    </mat-select>
                                                                </mat-form-field>
                                                            </div>
                                                        </div>
                                                    </mat-card-content>
                                                </mat-card>
                                                <!-- Egresos  -->
                                                <mat-card class="mat-card-fases">
                                                    <mat-card-header>
                                                        <mat-card-title>Egresos</mat-card-title>
                                                        <mat-chip-list class="pull-right">
                                                            <mat-chip color="accent" selected>
                                                                $ {{lote.value.totalEgresos}}
                                                            </mat-chip>
                                                        </mat-chip-list>
                                                    </mat-card-header>
                                                    <mat-card-content>
                                                        <div formArrayName="egresos" class="alternate">
                                                            <div fxLayout="row wrap"
                                                                *ngFor="let egreso of egresosPecuario(ac,lot).controls; let eg=index"
                                                                class="content" [formGroupName]="eg">
                                                                <button type="button" class="btndelete" color="warn"
                                                                    mat-icon-button [disabled]="eg ==0"
                                                                    (click)="removeEgresos(ac,lot,eg)">
                                                                    <mat-icon>cancel</mat-icon>
                                                                </button>
                                                                <div class="gr" fxFlex="50%" fxFlex.xs="50%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <mat-label>Descripcion</mat-label>
                                                                        <mat-select formControlName="descripcion"
                                                                            id="descripcion{{ac}}-{{lot}}" required>
                                                                            <mat-option *ngFor="let det of detallepecu"
                                                                                [value]="det.id">
                                                                                {{det.name}}
                                                                            </mat-option>
                                                                        </mat-select>
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="50%" fxFlex.xs="50%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <input type="text" matInput
                                                                            placeholder="Detalle"
                                                                            id="detalle{{lot}}-{{eg}}"
                                                                            formControlName="detalle">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="40%" fxFlex.xs="20%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <input type="number" matInput
                                                                            placeholder="Cantidad"
                                                                            id="cantidad{{lot}}-{{eg}}"
                                                                            formControlName="cantidad">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="35%" fxFlex.xs="40%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <input type="tel" matInput
                                                                            placeholder="Valor Unitario"
                                                                            id="valorunitario{{lot}}-{{eg}}"
                                                                            formControlName="valorunitario">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="35%" fxFlex.xs="40%"
                                                                    fxFlex.sm="25%">
                                                                    <mat-form-field>
                                                                        <input type="tel" matInput placeholder="Total"
                                                                            id="total{{lot}}-{{eg}}"
                                                                            formControlName="total">
                                                                    </mat-form-field>
                                                                </div>
                                                                <div class="gr" fxFlex="40%" fxFlex.xs="100%"
                                                                    fxFlex.sm="100%">
                                                                    <mat-form-field>
                                                                        <mat-label>Mes</mat-label>
                                                                        <mat-select formControlName="mes" multiple
                                                                            id="mes{{lot}}-{{eg}}" required>
                                                                            <mat-option *ngFor="let mes of meses"
                                                                                [value]="mes.id">
                                                                                {{mes.name}}
                                                                            </mat-option>
                                                                        </mat-select>
                                                                    </mat-form-field>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <button mat-fab aria-label="add" (click)="addEgresos(ac,lot)"
                                                            mat-mini-fab class="btnadd" type="button" color="accent">
                                                            <mat-icon>add</mat-icon>
                                                        </button>
                                                    </mat-card-content>
                                                </mat-card>
                                            </div>
                                        </mat-expansion-panel>
                                    </mat-accordion>
                                </div>
                            </ng-container>
                            <!-- otras actividades -->
                            <ng-container *ngSwitchDefault>
                                <mat-accordion class="example-headers-align" multi>
                                    <mat-expansion-panel>
                                        <mat-expansion-panel-header>
                                            <mat-panel-title>
                                                Cruce #1
                                            </mat-panel-title>
                                            <mat-panel-description>
                                                Ventas
                                                <mat-icon>account_balance</mat-icon>
                                            </mat-panel-description>
                                        </mat-expansion-panel-header>
                                        <!-- ventas b r m  -->
                                        <div fxLayout="row wrap">
                                            <mat-card class="radioperiodo">
                                                <mat-card-content>
                                                    <mat-radio-group formControlName="periodoventas" (change)="changeperiodo(acti)">
                                                        <mat-radio-button value="1">Dia</mat-radio-button>
                                                        <mat-radio-button value="2">Semana</mat-radio-button>
                                                        <mat-radio-button value="3">Quincena</mat-radio-button>
                                                    </mat-radio-group>
                                                </mat-card-content>
                                            </mat-card>
                                            <div class="gr" fxFlex="30%" fxFlex.xs="33%" fxFlex.sm="25%">
                                                <ng-container [ngSwitch]="acti.value.periodoventas">
                                                    <ng-container *ngSwitchCase="1">
                                                        <mat-form-field>
                                                            <mat-label>Buenas</mat-label>
                                                            <mat-select formControlName="diasB" multiple>
                                                                <mat-option *ngFor="let d of diasSemana" [value]="d.id"
                                                                    [disabled]="acti.value.diasR.indexOf(d.id) >= 0 || acti.value.diasM.indexOf(d.id) >= 0">
                                                                    {{d.name}}
                                                                </mat-option>
                                                            </mat-select>
                                                        </mat-form-field>
                                                    </ng-container>
                                                    <ng-container *ngSwitchCase="2">
                                                        <mat-form-field>
                                                            <mat-label>Buenas</mat-label>
                                                            <mat-select formControlName="diasB" multiple>
                                                                <mat-option *ngFor="let d of semanas" [value]="d.id"
                                                                    [disabled]="acti.value.diasR.indexOf(d.id) >= 0 || acti.value.diasM.indexOf(d.id) >= 0">
                                                                    {{d.name}}
                                                                </mat-option>
                                                            </mat-select>
                                                        </mat-form-field>
                                                    </ng-container>
                                                    <ng-container *ngSwitchCase="3">
                                                        <mat-form-field>
                                                            <mat-label>Buenas</mat-label>
                                                            <mat-select formControlName="diasB" multiple>
                                                                <mat-option *ngFor="let d of quincena" [value]="d.id"
                                                                    [disabled]="acti.value.diasR.indexOf(d.id) >= 0 || acti.value.diasM.indexOf(d.id) >= 0">
                                                                    {{d.name}}
                                                                </mat-option>
                                                            </mat-select>
                                                        </mat-form-field>
                                                    </ng-container>

                                                </ng-container>
                                            </div>

                                            <div class="gr" fxFlex="30%" fxFlex.xs="33%" fxFlex.sm="25%">
                                                <mat-form-field>
                                                    <input type="tel" matInput placeholder="Valor Buenas"
                                                        id="valorB{{ac}}" formControlName="valorB">
                                                </mat-form-field>
                                            </div>

                                            <div class="gr" fxFlex="30%" fxFlex.xs="33%" fxFlex.sm="25%">
                                                <mat-form-field>
                                                    <input type="text" readonly matInput placeholder="Total"
                                                        id="totalB{{ac}}" formControlName="totalB">
                                                </mat-form-field>
                                            </div>
                                            <ng-content *ngIf="acti.value.periodoventas !=3; then regulares">
                                            </ng-content>
                                            <ng-template #regulares>
                                                <div class="gr" fxFlex="30%" fxFlex.xs="33%" fxFlex.sm="25%">
                                                    <ng-container [ngSwitch]="acti.value.periodoventas">
                                                        <ng-container *ngSwitchCase="1">
                                                            <mat-form-field>
                                                                <mat-label>Regulares</mat-label>
                                                                <mat-select formControlName="diasR" multiple>
                                                                    <mat-option *ngFor="let d of diasSemana"
                                                                        [value]="d.id"
                                                                        [disabled]="acti.value.diasB.indexOf(d.id) >= 0 || acti.value.diasM.indexOf(d.id) >= 0">
                                                                        {{d.name}}
                                                                    </mat-option>
                                                                </mat-select>
                                                            </mat-form-field>
                                                        </ng-container>
                                                        <ng-container *ngSwitchCase="2">
                                                            <mat-form-field>
                                                                <mat-label>Regulares</mat-label>
                                                                <mat-select formControlName="diasR" multiple>
                                                                    <mat-option *ngFor="let d of semanas" [value]="d.id"
                                                                        [disabled]="acti.value.diasB.indexOf(d.id) >= 0 || acti.value.diasM.indexOf(d.id) >= 0">
                                                                        {{d.name}}
                                                                    </mat-option>
                                                                </mat-select>
                                                            </mat-form-field>
                                                        </ng-container>
                                                        <ng-container *ngSwitchCase="3">
                                                            <mat-form-field>
                                                                <mat-label>Regulares</mat-label>
                                                                <mat-select formControlName="diasR" multiple>
                                                                    <mat-option *ngFor="let d of quincena"
                                                                        [value]="d.id"
                                                                        [disabled]="acti.value.diasB.indexOf(d.id) >= 0 || acti.value.diasM.indexOf(d.id) >= 0">
                                                                        {{d.name}}
                                                                    </mat-option>
                                                                </mat-select>
                                                            </mat-form-field>
                                                        </ng-container>

                                                    </ng-container>
                                                </div>
                                                <div class="gr" fxFlex="30%" fxFlex.xs="33%" fxFlex.sm="25%">
                                                    <mat-form-field>
                                                        <input type="tel" matInput placeholder="Valor Regulares"
                                                            id="valorR{{ac}}" formControlName="valorR">
                                                    </mat-form-field>
                                                </div>
                                                <div class="gr" fxFlex="30%" fxFlex.xs="33%" fxFlex.sm="25%">
                                                    <mat-form-field>
                                                        <input type="text" readonly matInput placeholder="Total"
                                                            id="totalR{{ac}}" formControlName="totalR">
                                                    </mat-form-field>
                                                </div>
                                            </ng-template>

                                            <div class="gr" fxFlex="30%" fxFlex.xs="33%" fxFlex.sm="25%">
                                                <ng-container [ngSwitch]="acti.value.periodoventas">
                                                    <ng-container *ngSwitchCase="1">
                                                        <mat-form-field>
                                                            <mat-label>Malas</mat-label>
                                                            <mat-select formControlName="diasM" multiple>
                                                                <mat-option *ngFor="let d of diasSemana" [value]="d.id"
                                                                    [disabled]="acti.value.diasR.indexOf(d.id) >= 0 || acti.value.diasB.indexOf(d.id) >= 0">
                                                                    {{d.name}}
                                                                </mat-option>
                                                            </mat-select>
                                                        </mat-form-field>
                                                    </ng-container>
                                                    <ng-container *ngSwitchCase="2">
                                                        <mat-form-field>
                                                            <mat-label>Malas</mat-label>
                                                            <mat-select formControlName="diasM" multiple>
                                                                <mat-option *ngFor="let d of semanas" [value]="d.id"
                                                                    [disabled]="acti.value.diasR.indexOf(d.id) >= 0 || acti.value.diasB.indexOf(d.id) >= 0">
                                                                    {{d.name}}
                                                                </mat-option>
                                                            </mat-select>
                                                        </mat-form-field>
                                                    </ng-container>
                                                    <ng-container *ngSwitchCase="3">
                                                        <mat-form-field>
                                                            <mat-label>Malas</mat-label>
                                                            <mat-select formControlName="diasM" multiple>
                                                                <mat-option *ngFor="let d of quincena" [value]="d.id"
                                                                    [disabled]="acti.value.diasR.indexOf(d.id) >= 0 || acti.value.diasB.indexOf(d.id) >= 0">
                                                                    {{d.name}}
                                                                </mat-option>
                                                            </mat-select>
                                                        </mat-form-field>
                                                    </ng-container>
                                                </ng-container>
                                            </div>
                                            <div class="gr" fxFlex="30%" fxFlex.xs="33%" fxFlex.sm="25%">
                                                <mat-form-field>
                                                    <input type="tel" matInput placeholder="Valor Malas"
                                                        id="valorM{{ac}}" formControlName="valorM">
                                                </mat-form-field>
                                            </div>
                                            <div class="gr" fxFlex="30%" fxFlex.xs="33%" fxFlex.sm="25%">
                                                <mat-form-field>
                                                    <input type="text" readonly matInput placeholder="Total"
                                                        id="totalM{{ac}}" formControlName="totalM">
                                                </mat-form-field>
                                            </div>
                                            <div class="gr" fxFlex="100%" fxFlex.xs="100%" fxFlex.sm="100%">
                                                <mat-form-field>
                                                    <input type="text" readonly matInput placeholder="Total"
                                                        id="totalVentas{{ac}}" formControlName="totalVentas">
                                                </mat-form-field>
                                            </div>
                                            <div class="gr" fxFlex="30%" fxFlex.xs="40%" fxFlex.sm="25%">
                                                <mat-form-field appearance="outline">
                                                    <mat-label>Promedio</mat-label>
                                                    <input matInput type="text" readonly id="promedio{{ac}}"
                                                        formControlName="promedio">
                                                    <mat-icon matSuffix>attach_money</mat-icon>
                                                </mat-form-field>
                                            </div>
                                            <div class="gr" fxFlex="30%" fxFlex.xs="20%" fxFlex.sm="15%">
                                                <mat-form-field appearance="outline">
                                                    <mat-label>Dias</mat-label>
                                                    <input matInput type="number" matInput placeholder="Dias"
                                                        id="totalDias{{ac}}" formControlName="totalDias">
                                                </mat-form-field>
                                            </div>
                                            <div class="gr" fxFlex="30%" fxFlex.xs="40%" fxFlex.sm="25%">
                                                <mat-form-field appearance="outline">
                                                    <mat-label>Total Promedio</mat-label>
                                                    <input type="text" readonly matInput placeholder="Total Promedio"
                                                        id="totalPromedio{{ac}}" formControlName="totalPromedio">
                                                    <mat-icon matSuffix>attach_money</mat-icon>
                                                </mat-form-field>
                                            </div>
                                            <mat-card>
                                                <mat-card-header>
                                                    <mat-card-title>Resumen Ingreso</mat-card-title>
                                                </mat-card-header>
                                                <mat-card-content>
                                                    <div fxLayout="row wrap">

                                                        <div class="gr" fxFlex="25%" fxFlex.xs="50%" fxFlex.sm="45%">
                                                            <mat-form-field>
                                                                <input type="tel" autocomplete="off" matInput
                                                                    placeholder="Total Compras" required formControlName="totalCompras">
                                                            </mat-form-field>
                                                        </div>
                                                        <div class="gr" fxFlex="25%" fxFlex.xs="50%" fxFlex.sm="45%">
                                                            <mat-form-field>
                                                                <input type="tel" autocomplete="off" matInput readonly
                                                                    placeholder="Ventas Estimadas" required formControlName="ventasEstimadas">
                                                            </mat-form-field>
                                                        </div>
                                                        <div class="gr" fxFlex="25%" fxFlex.xs="50%" fxFlex.sm="45%">
                                                            <mat-form-field>
                                                                <input type="tel" autocomplete="off" matInput
                                                                    placeholder="Margen Bruto" required formControlName="margenBruto">
                                                            </mat-form-field>
                                                        </div>
                                                        <div class="gr" fxFlex="25%" fxFlex.xs="50%" fxFlex.sm="45%">
                                                            <mat-form-field>
                                                                <input type="tel" autocomplete="off" matInput
                                                                    placeholder="Otros Gastos" required formControlName="otrosGastos">
                                                            </mat-form-field>
                                                        </div>
                                                        <div class="gr" fxFlex="100%" fxFlex.xs="100%" fxFlex.sm="100%">
                                                            <mat-form-field appearance="outline">
                                                                <mat-label>Ingreso Liquido</mat-label>
                                                                <input matInput type="text" readonly id="ingresoLiquido{{ac}}"
                                                                    formControlName="ingresoLiquido">
                                                                <mat-icon matSuffix>attach_money</mat-icon>
                                                            </mat-form-field>
                                                        </div>                                                      
                                                    </div>
                                                </mat-card-content>
                                            </mat-card>
                                        </div>
                                    </mat-expansion-panel>
                                </mat-accordion>
                            </ng-container>
                        </ng-container>

                    </div>
                </mat-tab>
            </div>
        </mat-tab-group>
    </form>
</ng-container>